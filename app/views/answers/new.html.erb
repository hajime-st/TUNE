<div class="mx-auto container flex flex-col pt-10">
    <%= form_with url: new_theme_answer_path, method: :get, html: { data: { turbo_frame: "song_search" } } do |form| %>
    <div class="flex flex-col items-center">
      <div class="text-xl md:text-2xl mb-3">曲を検索して解答を投稿する</div>
      <div class="text-sm">1つのお題につき1人1曲のみ回答できます。</div>
      <div class="flex w-full justify-center">
        <%= form.text_field :search, placeholder:"曲名、アーティスト名で検索", autocomplete: 'off',
            class: "w-full md:w-6/10 lg:w-1/2 mt-2 border-black border-2 rounded py-3 px-3 leading-tight focus:bg-white focus:border-black focus:ring-0 placeholder-gray-800 appearance-none" %>
        <%= button_tag(type: "submit", class: "mt-2") do %>
          <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
            <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
            <circle cx="10" cy="10" r="7"></circle>
            <line x1="21" y1="21" x2="15" y2="15"></line>
          </svg>
        <% end %>
      </div>
      <% end %>
  </div>
</div>

<div class="px-4 md:px-36 lg:px-64 xl:px-80 2xl:px-96">
  <%= turbo_frame_tag "song_search" do %>
    <div class="flex flex-col items-center text-center">
      <% if @search_params %>
        <div class="text-lg mt-5"><%= (t 'themes.search.result') %></div>
        <div class="font-bold text-2xl mt-1 mb-4"><%= @search_params %></div>
      <% end %>
    </div>
    <% if @songs %>
      <% @songs.each do |song| %>
      <div class="my-4">
        <iframe class="mb-2" style="border-radius:12px" src="https://open.spotify.com/embed/track/<%= song.id %>?utm_source=generator" width="100%" height="152" frameBorder="0" allowfullscreen="" allow="autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture" loading="lazy"></iframe>
        <% if current_user %>
          <% if @theme_genre.empty? %>
            <%= render 'answer_menus', {theme: @theme, my_answer: @my_answer, song: song} %>
          <% elsif @theme_genre.first === "洋楽" && !genre_include?(song.artists.first.genres, @theme_genre) %>
            <%= render 'answer_menus', {theme: @theme, my_answer: @my_answer, song: song} %>
          <% elsif @theme_genre.first != "洋楽" && genre_include?(song.artists.first.genres, @theme_genre) %>
            <%= render 'answer_menus', {theme: @theme, my_answer: @my_answer, song: song} %>
          <% else %>
            この曲はジャンル対象外です
          <% end %>
        <% end %>
      </div>
      <% end %>
    <% end %>
  <% end %>
  </div>
</div>