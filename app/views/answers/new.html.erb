<div class="px-48 flex flex-col items-center">
  <%= form_with url: new_theme_answer_path, method: :get, html: { data: { turbo_frame: "song_search" } } do |form| %>
    <div class="text-m md:text-xl">曲名、アーティスト名で検索</div>
    <%= form.text_field :search %>
    <%= form.submit (t 'themes.search.search'), name: nil %>
  <% end %>
</div>

<div class="px-4 md:px-44 lg:px-64 xl:px-80 2xl:px-96">
  <%= turbo_frame_tag "song_search" do %>
    <h4><%= "#{(t 'themes.search.result')}: #{@search_params}" %></h4>
    <% if @songs %>
      <% @songs.each do |song| %>
      <div class="my-4">
        <iframe class="mb-2" style="border-radius:12px" src="https://open.spotify.com/embed/track/<%= song.id %>?utm_source=generator" width="100%" height="152" frameBorder="0" allowfullscreen="" allow="autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture" loading="lazy"></iframe>
        <% if current_user %>
          <% if @theme_genre.empty? %>
            <%= render 'answer_menus', {theme: @theme, my_answer: @my_answer, song: song} %>
          <% elsif @theme_genre.first === "洋楽" && !genre_include?(song.artists.first.genres, @theme_genre) %>
            <%= render 'answer_menus', {theme: @theme, my_answer: @my_answer, song: song} %>
          <% elsif @theme_genre.first != "洋楽" && genre_include?(song.artists.first.genres, @theme_genre) %>
            <%= render 'answer_menus', {theme: @theme, my_answer: @my_answer, song: song} %>
          <% else %>
            この曲はジャンル対象外です
          <% end %>
        <% end %>
      </div>
      <% end %>
    <% end %>
  <% end %>
  <%# if @theme_genre.empty? || !song.artists.first.genres.grep(/#{@theme_genre.second}/).empty? || !song.artists.first.genres.grep(/#{@theme_genre.third}/).empty? %>
</div>